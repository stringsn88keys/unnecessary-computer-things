#C64Studio.MetaData.BASIC:2049,BASIC V2
100 POKE 36879,8: CO=30720: LI=3
110 DIM S(4),B(2): DI=99:UP=99
120 DEF FNY(DI)=INT((S(DI)-7680)/22)
130 DEF FNX(DI)=S(DI)-(Y*22+7680)
140 G=8174: S=0
150 PRINT "" TAB(7) "  "
160 PRINT TAB(4) "          "
170 PRINT "        "
180 PRINT "  "
190 PRINT TAB(3) "   "
200 PRINT TAB(4) ""
210 PRINT TAB(5) " . . . . "
220 PRINT TAB(7) "   "
230 PRINT "SCORE" TAB(11) "LIVES"
240 POKE G-1+CO,1: POKE G-1,112: POKE G+CO,1:POKE G,113: POKE G+1+CO,1:POKE G+1,110
250 PRINT ""S;LITAB(16) LI
260 FOR I=0 TO 4:IF I=DI OR I=UP OR S(I)=0 THEN 310
270 D=INT(RND(1)*3-1)+INT(RND(1)*3-1)*22
280 IF S(I)+D<7724 OR S(I)+D>7811 THEN D=0
290 IF PEEK(S(I)+D)<>32 THEN D=0: GOTO 310
300 POKE S(I),32: S(I)=S(I)+D:POKE S(I)+CO,3: POKE S(I),88
310 IF PEEK(G-1)<>112 OR PEEK(G)<>113 OR PEEK(G+1)<>110 THEN 800
320 K=PEEK(197): IF K=64 THEN 540
330 IF K=36 THEN 370
340 POKE G-1,32:POKE G+1,32:G=G-(K=33)*(G>8165)+(K=34)*(G<8184)
350 POKE G-1+CO,1:POKE G+CO,1: POKE G+1+CO,1
360 POKE G-1,112: POKE G,113: POKE G+1,110: GOTO 540
370 POKE 36878,9: FOR J=250 TO 210 STEP -1: POKE 36877,J: NEXT: J=G-22
380 P=PEEK(J): IF P<>32 AND P<>88 AND P<>46 THEN J=J+22: GOTO 500
390 POKE J+CO,7:POKE J,93: IF P=32 THEN 510
400 POKE J+CO,2: POKE J,42
410 POKE 36878,15:POKE 36877,130
420 IF DI=99 THEN 460
430 IF S(DI)<>J THEN 460
440 POKE 36876,0
450 S(DI)=0:S=S+20:DI=99:POKE J,P1:POKE J+CO,C1: J=J+22
460 FOR I1=0TO4:IF S(I1)=J THEN S=S+10:S(I1)=0
470 NEXT
480 FOR I1=0TO2:IF B(I1)=J THEN B(I1)=0:S=S+5
490 NEXT:POKE 36877,210
500 GOTO 530
510 J=J-22:IF J>7679 THEN 380
520 J=J+22
530 POKE 36877,0:FOR I1=G-22 TO J STEP -22:POKE I1,32:NEXT
540 IF UP<99 THEN 570
550 UP=INT(RND(1)*5):IF S(UP)>0 OR RND(1)<.7 THEN UP=99: GOTO 590
560 S(UP)=7910
570 IFS(UP)<7724 OR S(UP)<7768 AND RND(1)>.4THEN UP=99: GOTO 590
580 POKES(UP),32:S(UP)=S(UP)-22:POKES(UP)+CO,5:POKES(UP),88
590 IF DI<99 THEN 620
600 DI=INT(RND(1)*5):IF DI=UP OR S(DI)=0 OR RND(1)<.8 THEN DI=99: GOTO 690
610 P1=32:C1=0
620 Y=FNY(DI):X=FNX(DI):D=22
630 POKE 36878,12:POKE 36876,(25-Y/6)*10
640 IF X>=10 AND Y<7 OR X<15 AND Y>15 THEN D=D+1: GOTO 660
650 IF X<10 AND Y<10 OR X>=10 AND Y>5 AND Y<15 THEN D=D-1
660 POKE S(DI)+CO,C1:POKE S(DI),P1
670 S(DI)=S(DI)+D:IFS(DI)>8185 THEN S(DI)=0:DI=99:POKE 36876,0: GOTO 690
680 P1=PEEK(S(DI)):C1=PEEK(S(DI)+CO):POKES(DI)+CO,4:POKES(DI),88
690 FOR J=0TO2:IF B(J)>0 THEN 740
700 IF DI=99 OR RND(1)<.7 THEN 790
710 IF PEEK(G-1)<>112 OR PEEK(G)<>113 OR PEEK (G+1)<>110 THEN 800
720 IF S(DI)<7980 THEN 790
730 B(J)=S(DI)+22
740 POKE B(J),32:B(J)=B(J)+22: IF B(J)>8185 THEN B(J)=0: GOTO 790
750 IF PEEK(B(J))=32 THEN 780
760 IF ABS(B(J)-G)<2 THEN 800
770 B(J)=0:GOTO 790
780 POKE B(J)+CO,1:POKE B(J),46
790 NEXT J,I: GOTO 250
800 POKE G-1+CO,2:POKE G+20,2:POKE G+1+CO,2:POKE 36876,0: POKE 36877,140
810 FOR I=1TO25:POKE G-1,223: POKE G,223: POKE G+1,223
820 POKE 36878,15-(I/1.7):FOR J=1 TO 50:NEXT
830 POKE G-1,233:POKE G,233:POKE G+1,233
840 FOR J=1 TO 50: NEXT J,I
850 FOR I=0TO2:IF B(I)>0 THEN POKE B(I), 32
860 B(I)=0: NEXT: POKE 36877,0: POKE 36878,0
870 LI=LI-1: IF LI>0 THEN 240
880 FOR I=1 TO 5000:NEXT: RUN
